{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/Hack-the-Thread-Social-Saver-Bot-Prototype/lib/db.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\"\r\n\r\nconst globalForPrisma = globalThis as unknown as { prisma: PrismaClient | undefined }\r\n\r\nexport const prisma =\r\n  globalForPrisma.prisma ??\r\n  new PrismaClient({\r\n    log: process.env.NODE_ENV === \"development\" ? [\"error\", \"warn\"] : [\"error\"],\r\n  })\r\n\r\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAEjB,MAAM,SACX,gBAAgB,MAAM,IACtB,IAAI,sMAAY,CAAC;IACf,KAAK,uCAAyC;QAAC;QAAS;KAAO,GAAG;AACpE;AAEF,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///D:/Hack-the-Thread-Social-Saver-Bot-Prototype/lib/auth.ts"],"sourcesContent":["import { cookies } from \"next/headers\"\r\nimport { prisma } from \"@/lib/db\"\r\n\r\n// ── Types ────────────────────────────────────────────────────────────────\r\nexport interface User {\r\n  id: string\r\n  identifier: string\r\n  type: \"email\" | \"phone\"\r\n  createdAt: string\r\n}\r\n\r\nexport interface Session {\r\n  id: string\r\n  userId: string\r\n  expiresAt: number\r\n}\r\n\r\nconst SESSION_COOKIE = \"social-saver-session\"\r\nconst OTP_TTL_MS = 5 * 60 * 1000 // 5 minutes\r\nconst SESSION_TTL_MS = 24 * 60 * 60 * 1000 // 24 hours\r\n\r\n// ── OTP ──────────────────────────────────────────────────────────────────\r\nexport async function generateOtp(identifier: string): Promise<string> {\r\n  const code = String(Math.floor(100000 + Math.random() * 900000))\r\n  const expiresAt = new Date(Date.now() + OTP_TTL_MS)\r\n\r\n  await prisma.otp.upsert({\r\n    where: { identifier },\r\n    create: { identifier, code, expiresAt },\r\n    update: { code, expiresAt },\r\n  })\r\n\r\n  return code\r\n}\r\n\r\nexport async function verifyOtp(identifier: string, code: string): Promise<boolean> {\r\n  const row = await prisma.otp.findUnique({ where: { identifier } })\r\n  if (!row) return false\r\n  if (new Date() > row.expiresAt) {\r\n    await prisma.otp.delete({ where: { identifier } }).catch(() => {})\r\n    return false\r\n  }\r\n  if (row.code !== code) return false\r\n  await prisma.otp.delete({ where: { identifier } })\r\n  return true\r\n}\r\n\r\n// ── Users ────────────────────────────────────────────────────────────────\r\nexport async function findOrCreateUser(\r\n  identifier: string,\r\n  type: \"email\" | \"phone\"\r\n): Promise<User> {\r\n  const existing = await prisma.user.findUnique({\r\n    where: { identifier },\r\n  })\r\n  if (existing) {\r\n    return toUser(existing)\r\n  }\r\n\r\n  const user = await prisma.user.create({\r\n    data: { identifier, type },\r\n  })\r\n  return toUser(user)\r\n}\r\n\r\nexport async function getUserById(id: string): Promise<User | undefined> {\r\n  const user = await prisma.user.findUnique({ where: { id } })\r\n  return user ? toUser(user) : undefined\r\n}\r\n\r\nfunction toUser(row: { id: string; identifier: string; type: string; createdAt: Date }): User {\r\n  return {\r\n    id: row.id,\r\n    identifier: row.identifier,\r\n    type: row.type as \"email\" | \"phone\",\r\n    createdAt: row.createdAt.toISOString(),\r\n  }\r\n}\r\n\r\n// ── Sessions ─────────────────────────────────────────────────────────────\r\nexport async function createSession(userId: string): Promise<Session> {\r\n  const expiresAt = new Date(Date.now() + SESSION_TTL_MS)\r\n  const session = await prisma.session.create({\r\n    data: { userId, expiresAt },\r\n  })\r\n  return {\r\n    id: session.id,\r\n    userId: session.userId,\r\n    expiresAt: expiresAt.getTime(),\r\n  }\r\n}\r\n\r\nexport async function getSession(sessionId: string): Promise<Session | null> {\r\n  const session = await prisma.session.findUnique({\r\n    where: { id: sessionId },\r\n  })\r\n  if (!session) return null\r\n  if (new Date() > session.expiresAt) {\r\n    await prisma.session.delete({ where: { id: sessionId } }).catch(() => {})\r\n    return null\r\n  }\r\n  return {\r\n    id: session.id,\r\n    userId: session.userId,\r\n    expiresAt: session.expiresAt.getTime(),\r\n  }\r\n}\r\n\r\nexport async function deleteSession(sessionId: string): Promise<void> {\r\n  await prisma.session.delete({ where: { id: sessionId } }).catch(() => {})\r\n}\r\n\r\n// ── Session + Cookie helpers for route handlers ──────────────────────────\r\nexport async function getAuthenticatedUser(): Promise<{\r\n  user: User\r\n  session: Session\r\n} | null> {\r\n  const cookieStore = await cookies()\r\n  const sessionId = cookieStore.get(SESSION_COOKIE)?.value\r\n  if (!sessionId) return null\r\n\r\n  const session = await getSession(sessionId)\r\n  if (!session) return null\r\n\r\n  const user = await getUserById(session.userId)\r\n  if (!user) return null\r\n\r\n  return { user, session }\r\n}\r\n\r\nexport function getSessionCookieName(): string {\r\n  return SESSION_COOKIE\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AACA;;;AAgBA,MAAM,iBAAiB;AACvB,MAAM,aAAa,IAAI,KAAK,KAAK,YAAY;;AAC7C,MAAM,iBAAiB,KAAK,KAAK,KAAK,KAAK,WAAW;;AAG/C,eAAe,YAAY,UAAkB;IAClD,MAAM,OAAO,OAAO,KAAK,KAAK,CAAC,SAAS,KAAK,MAAM,KAAK;IACxD,MAAM,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK;IAExC,MAAM,qHAAM,CAAC,GAAG,CAAC,MAAM,CAAC;QACtB,OAAO;YAAE;QAAW;QACpB,QAAQ;YAAE;YAAY;YAAM;QAAU;QACtC,QAAQ;YAAE;YAAM;QAAU;IAC5B;IAEA,OAAO;AACT;AAEO,eAAe,UAAU,UAAkB,EAAE,IAAY;IAC9D,MAAM,MAAM,MAAM,qHAAM,CAAC,GAAG,CAAC,UAAU,CAAC;QAAE,OAAO;YAAE;QAAW;IAAE;IAChE,IAAI,CAAC,KAAK,OAAO;IACjB,IAAI,IAAI,SAAS,IAAI,SAAS,EAAE;QAC9B,MAAM,qHAAM,CAAC,GAAG,CAAC,MAAM,CAAC;YAAE,OAAO;gBAAE;YAAW;QAAE,GAAG,KAAK,CAAC,KAAO;QAChE,OAAO;IACT;IACA,IAAI,IAAI,IAAI,KAAK,MAAM,OAAO;IAC9B,MAAM,qHAAM,CAAC,GAAG,CAAC,MAAM,CAAC;QAAE,OAAO;YAAE;QAAW;IAAE;IAChD,OAAO;AACT;AAGO,eAAe,iBACpB,UAAkB,EAClB,IAAuB;IAEvB,MAAM,WAAW,MAAM,qHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QAC5C,OAAO;YAAE;QAAW;IACtB;IACA,IAAI,UAAU;QACZ,OAAO,OAAO;IAChB;IAEA,MAAM,OAAO,MAAM,qHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;QACpC,MAAM;YAAE;YAAY;QAAK;IAC3B;IACA,OAAO,OAAO;AAChB;AAEO,eAAe,YAAY,EAAU;IAC1C,MAAM,OAAO,MAAM,qHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QAAE,OAAO;YAAE;QAAG;IAAE;IAC1D,OAAO,OAAO,OAAO,QAAQ;AAC/B;AAEA,SAAS,OAAO,GAAsE;IACpF,OAAO;QACL,IAAI,IAAI,EAAE;QACV,YAAY,IAAI,UAAU;QAC1B,MAAM,IAAI,IAAI;QACd,WAAW,IAAI,SAAS,CAAC,WAAW;IACtC;AACF;AAGO,eAAe,cAAc,MAAc;IAChD,MAAM,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK;IACxC,MAAM,UAAU,MAAM,qHAAM,CAAC,OAAO,CAAC,MAAM,CAAC;QAC1C,MAAM;YAAE;YAAQ;QAAU;IAC5B;IACA,OAAO;QACL,IAAI,QAAQ,EAAE;QACd,QAAQ,QAAQ,MAAM;QACtB,WAAW,UAAU,OAAO;IAC9B;AACF;AAEO,eAAe,WAAW,SAAiB;IAChD,MAAM,UAAU,MAAM,qHAAM,CAAC,OAAO,CAAC,UAAU,CAAC;QAC9C,OAAO;YAAE,IAAI;QAAU;IACzB;IACA,IAAI,CAAC,SAAS,OAAO;IACrB,IAAI,IAAI,SAAS,QAAQ,SAAS,EAAE;QAClC,MAAM,qHAAM,CAAC,OAAO,CAAC,MAAM,CAAC;YAAE,OAAO;gBAAE,IAAI;YAAU;QAAE,GAAG,KAAK,CAAC,KAAO;QACvE,OAAO;IACT;IACA,OAAO;QACL,IAAI,QAAQ,EAAE;QACd,QAAQ,QAAQ,MAAM;QACtB,WAAW,QAAQ,SAAS,CAAC,OAAO;IACtC;AACF;AAEO,eAAe,cAAc,SAAiB;IACnD,MAAM,qHAAM,CAAC,OAAO,CAAC,MAAM,CAAC;QAAE,OAAO;YAAE,IAAI;QAAU;IAAE,GAAG,KAAK,CAAC,KAAO;AACzE;AAGO,eAAe;IAIpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,MAAM,YAAY,YAAY,GAAG,CAAC,iBAAiB;IACnD,IAAI,CAAC,WAAW,OAAO;IAEvB,MAAM,UAAU,MAAM,WAAW;IACjC,IAAI,CAAC,SAAS,OAAO;IAErB,MAAM,OAAO,MAAM,YAAY,QAAQ,MAAM;IAC7C,IAAI,CAAC,MAAM,OAAO;IAElB,OAAO;QAAE;QAAM;IAAQ;AACzB;AAEO,SAAS;IACd,OAAO;AACT"}},
    {"offset": {"line": 230, "column": 0}, "map": {"version":3,"sources":["file:///D:/Hack-the-Thread-Social-Saver-Bot-Prototype/lib/data.ts"],"sourcesContent":["import { prisma } from \"@/lib/db\"\r\n\r\nexport interface SavedLink {\r\n  id: string\r\n  name: string\r\n  url: string\r\n  description: string\r\n  platform: Platform\r\n  createdAt: string\r\n  userId: string\r\n}\r\n\r\nexport type Platform =\r\n  | \"instagram\"\r\n  | \"twitter\"\r\n  | \"dribbble\"\r\n  | \"youtube\"\r\n  | \"blog\"\r\n  | \"other\"\r\n\r\nexport function detectPlatform(url: string): Platform {\r\n  const lower = url.toLowerCase()\r\n  if (lower.includes(\"instagram.com\") || lower.includes(\"instagr.am\"))\r\n    return \"instagram\"\r\n  if (\r\n    lower.includes(\"twitter.com\") ||\r\n    lower.includes(\"x.com\") ||\r\n    lower.includes(\"t.co\")\r\n  )\r\n    return \"twitter\"\r\n  if (lower.includes(\"dribbble.com\")) return \"dribbble\"\r\n  if (\r\n    lower.includes(\"youtube.com\") ||\r\n    lower.includes(\"youtu.be\") ||\r\n    lower.includes(\"yt.be\")\r\n  )\r\n    return \"youtube\"\r\n  if (\r\n    lower.includes(\"medium.com\") ||\r\n    lower.includes(\"dev.to\") ||\r\n    lower.includes(\"hashnode\") ||\r\n    lower.includes(\"substack.com\") ||\r\n    lower.includes(\"blog\")\r\n  )\r\n    return \"blog\"\r\n  return \"other\"\r\n}\r\n\r\nfunction toSavedLink(row: {\r\n  id: string\r\n  name: string\r\n  url: string\r\n  description: string\r\n  platform: string\r\n  createdAt: Date\r\n  userId: string\r\n}): SavedLink {\r\n  return {\r\n    id: row.id,\r\n    name: row.name,\r\n    url: row.url,\r\n    description: row.description,\r\n    platform: row.platform as Platform,\r\n    createdAt: row.createdAt.toISOString(),\r\n    userId: row.userId,\r\n  }\r\n}\r\n\r\n// ── All user-scoped query functions ──────────────────────────────────────\r\n\r\nexport async function getAllLinks(userId: string): Promise<SavedLink[]> {\r\n  const rows = await prisma.link.findMany({\r\n    where: { userId },\r\n    orderBy: { createdAt: \"desc\" },\r\n  })\r\n  return rows.map(toSavedLink)\r\n}\r\n\r\nexport async function addLink(\r\n  name: string,\r\n  url: string,\r\n  description: string,\r\n  userId: string\r\n): Promise<SavedLink> {\r\n  const platform = detectPlatform(url)\r\n  const link = await prisma.link.create({\r\n    data: { name, url, description, platform, userId },\r\n  })\r\n  return toSavedLink(link)\r\n}\r\n\r\nexport async function updateLink(\r\n  id: string,\r\n  userId: string,\r\n  updates: Partial<Pick<SavedLink, \"name\" | \"url\" | \"description\">>\r\n): Promise<SavedLink | null> {\r\n  const existing = await prisma.link.findFirst({\r\n    where: { id, userId },\r\n  })\r\n  if (!existing) return null\r\n\r\n  const data: { name?: string; url?: string; description?: string; platform?: string } = {}\r\n  if (updates.name !== undefined) data.name = updates.name\r\n  if (updates.description !== undefined) data.description = updates.description\r\n  if (updates.url !== undefined) {\r\n    data.url = updates.url\r\n    data.platform = detectPlatform(updates.url)\r\n  }\r\n\r\n  const link = await prisma.link.update({\r\n    where: { id },\r\n    data,\r\n  })\r\n  return toSavedLink(link)\r\n}\r\n\r\nexport async function deleteLink(id: string, userId: string): Promise<boolean> {\r\n  const result = await prisma.link.deleteMany({\r\n    where: { id, userId },\r\n  })\r\n  return result.count > 0\r\n}\r\n\r\nexport async function searchLinks(query: string, userId: string): Promise<SavedLink[]> {\r\n  const lower = query.toLowerCase()\r\n  const all = await getAllLinks(userId)\r\n  return all.filter(\r\n    (l) =>\r\n      l.name.toLowerCase().includes(lower) ||\r\n      l.description.toLowerCase().includes(lower) ||\r\n      l.url.toLowerCase().includes(lower)\r\n  )\r\n}\r\n\r\nexport async function filterByPlatform(\r\n  platform: Platform,\r\n  userId: string\r\n): Promise<SavedLink[]> {\r\n  const rows = await prisma.link.findMany({\r\n    where: { userId, platform },\r\n    orderBy: { createdAt: \"desc\" },\r\n  })\r\n  return rows.map(toSavedLink)\r\n}\r\n\r\nexport async function getStats(userId: string): Promise<{\r\n  total: number\r\n  platforms: number\r\n  thisWeek: number\r\n  lastAdded: string | null\r\n}> {\r\n  const all = await getAllLinks(userId)\r\n  const oneWeekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)\r\n  const thisWeek = all.filter((l) => new Date(l.createdAt) >= oneWeekAgo)\r\n  const platforms = new Set(all.map((l) => l.platform))\r\n\r\n  return {\r\n    total: all.length,\r\n    platforms: platforms.size,\r\n    thisWeek: thisWeek.length,\r\n    lastAdded: all[0]?.createdAt ?? null,\r\n  }\r\n}\r\n\r\nexport async function getPlatformCounts(userId: string): Promise<Record<string, number>> {\r\n  const all = await getAllLinks(userId)\r\n  const counts: Record<string, number> = {}\r\n  for (const link of all) {\r\n    counts[link.platform] = (counts[link.platform] || 0) + 1\r\n  }\r\n  return counts\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;;AAoBO,SAAS,eAAe,GAAW;IACxC,MAAM,QAAQ,IAAI,WAAW;IAC7B,IAAI,MAAM,QAAQ,CAAC,oBAAoB,MAAM,QAAQ,CAAC,eACpD,OAAO;IACT,IACE,MAAM,QAAQ,CAAC,kBACf,MAAM,QAAQ,CAAC,YACf,MAAM,QAAQ,CAAC,SAEf,OAAO;IACT,IAAI,MAAM,QAAQ,CAAC,iBAAiB,OAAO;IAC3C,IACE,MAAM,QAAQ,CAAC,kBACf,MAAM,QAAQ,CAAC,eACf,MAAM,QAAQ,CAAC,UAEf,OAAO;IACT,IACE,MAAM,QAAQ,CAAC,iBACf,MAAM,QAAQ,CAAC,aACf,MAAM,QAAQ,CAAC,eACf,MAAM,QAAQ,CAAC,mBACf,MAAM,QAAQ,CAAC,SAEf,OAAO;IACT,OAAO;AACT;AAEA,SAAS,YAAY,GAQpB;IACC,OAAO;QACL,IAAI,IAAI,EAAE;QACV,MAAM,IAAI,IAAI;QACd,KAAK,IAAI,GAAG;QACZ,aAAa,IAAI,WAAW;QAC5B,UAAU,IAAI,QAAQ;QACtB,WAAW,IAAI,SAAS,CAAC,WAAW;QACpC,QAAQ,IAAI,MAAM;IACpB;AACF;AAIO,eAAe,YAAY,MAAc;IAC9C,MAAM,OAAO,MAAM,qHAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;QACtC,OAAO;YAAE;QAAO;QAChB,SAAS;YAAE,WAAW;QAAO;IAC/B;IACA,OAAO,KAAK,GAAG,CAAC;AAClB;AAEO,eAAe,QACpB,IAAY,EACZ,GAAW,EACX,WAAmB,EACnB,MAAc;IAEd,MAAM,WAAW,eAAe;IAChC,MAAM,OAAO,MAAM,qHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;QACpC,MAAM;YAAE;YAAM;YAAK;YAAa;YAAU;QAAO;IACnD;IACA,OAAO,YAAY;AACrB;AAEO,eAAe,WACpB,EAAU,EACV,MAAc,EACd,OAAiE;IAEjE,MAAM,WAAW,MAAM,qHAAM,CAAC,IAAI,CAAC,SAAS,CAAC;QAC3C,OAAO;YAAE;YAAI;QAAO;IACtB;IACA,IAAI,CAAC,UAAU,OAAO;IAEtB,MAAM,OAAiF,CAAC;IACxF,IAAI,QAAQ,IAAI,KAAK,WAAW,KAAK,IAAI,GAAG,QAAQ,IAAI;IACxD,IAAI,QAAQ,WAAW,KAAK,WAAW,KAAK,WAAW,GAAG,QAAQ,WAAW;IAC7E,IAAI,QAAQ,GAAG,KAAK,WAAW;QAC7B,KAAK,GAAG,GAAG,QAAQ,GAAG;QACtB,KAAK,QAAQ,GAAG,eAAe,QAAQ,GAAG;IAC5C;IAEA,MAAM,OAAO,MAAM,qHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;QACpC,OAAO;YAAE;QAAG;QACZ;IACF;IACA,OAAO,YAAY;AACrB;AAEO,eAAe,WAAW,EAAU,EAAE,MAAc;IACzD,MAAM,SAAS,MAAM,qHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;QAC1C,OAAO;YAAE;YAAI;QAAO;IACtB;IACA,OAAO,OAAO,KAAK,GAAG;AACxB;AAEO,eAAe,YAAY,KAAa,EAAE,MAAc;IAC7D,MAAM,QAAQ,MAAM,WAAW;IAC/B,MAAM,MAAM,MAAM,YAAY;IAC9B,OAAO,IAAI,MAAM,CACf,CAAC,IACC,EAAE,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,UAC9B,EAAE,WAAW,CAAC,WAAW,GAAG,QAAQ,CAAC,UACrC,EAAE,GAAG,CAAC,WAAW,GAAG,QAAQ,CAAC;AAEnC;AAEO,eAAe,iBACpB,QAAkB,EAClB,MAAc;IAEd,MAAM,OAAO,MAAM,qHAAM,CAAC,IAAI,CAAC,QAAQ,CAAC;QACtC,OAAO;YAAE;YAAQ;QAAS;QAC1B,SAAS;YAAE,WAAW;QAAO;IAC/B;IACA,OAAO,KAAK,GAAG,CAAC;AAClB;AAEO,eAAe,SAAS,MAAc;IAM3C,MAAM,MAAM,MAAM,YAAY;IAC9B,MAAM,aAAa,IAAI,KAAK,KAAK,GAAG,KAAK,IAAI,KAAK,KAAK,KAAK;IAC5D,MAAM,WAAW,IAAI,MAAM,CAAC,CAAC,IAAM,IAAI,KAAK,EAAE,SAAS,KAAK;IAC5D,MAAM,YAAY,IAAI,IAAI,IAAI,GAAG,CAAC,CAAC,IAAM,EAAE,QAAQ;IAEnD,OAAO;QACL,OAAO,IAAI,MAAM;QACjB,WAAW,UAAU,IAAI;QACzB,UAAU,SAAS,MAAM;QACzB,WAAW,GAAG,CAAC,EAAE,EAAE,aAAa;IAClC;AACF;AAEO,eAAe,kBAAkB,MAAc;IACpD,MAAM,MAAM,MAAM,YAAY;IAC9B,MAAM,SAAiC,CAAC;IACxC,KAAK,MAAM,QAAQ,IAAK;QACtB,MAAM,CAAC,KAAK,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,QAAQ,CAAC,IAAI,CAAC,IAAI;IACzD;IACA,OAAO;AACT"}},
    {"offset": {"line": 369, "column": 0}, "map": {"version":3,"sources":["file:///D:/Hack-the-Thread-Social-Saver-Bot-Prototype/app/api/send-whatsapp/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\nimport { getAuthenticatedUser } from \"@/lib/auth\"\r\nimport { getAllLinks } from \"@/lib/data\"\r\n\r\nexport async function POST(request: NextRequest) {\r\n    const auth = await getAuthenticatedUser()\r\n    if (!auth) {\r\n        return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 })\r\n    }\r\n\r\n    try {\r\n        const body = await request.json()\r\n        const { receiverNumber } = body\r\n\r\n        if (!receiverNumber || typeof receiverNumber !== \"string\" || !receiverNumber.trim()) {\r\n            return NextResponse.json(\r\n                { error: \"WhatsApp number is required\" },\r\n                { status: 400 }\r\n            )\r\n        }\r\n\r\n        const links = await getAllLinks(auth.user.id)\r\n        if (!links || links.length === 0) {\r\n            return NextResponse.json(\r\n                { error: \"No saved links to send\" },\r\n                { status: 400 }\r\n            )\r\n        }\r\n\r\n        const automationServiceUrl = process.env.WHATSAPP_WORKER_URL || \"http://localhost:3001/send-message\"\r\n\r\n        let sentCount = 0;\r\n        for (const link of links) {\r\n            const messageText = `*${link.name}*\\n${link.description}\\n${link.url}`\r\n\r\n            try {\r\n                const res = await fetch(automationServiceUrl, {\r\n                    method: \"POST\",\r\n                    headers: { \"Content-Type\": \"application/json\" },\r\n                    body: JSON.stringify({\r\n                        receiverNumber: receiverNumber.trim(),\r\n                        messageText\r\n                    })\r\n                });\r\n\r\n                if (res.ok) {\r\n                    sentCount++;\r\n                } else {\r\n                    console.error(\"Failed to queue message for:\", link.name);\r\n                }\r\n            } catch (err) {\r\n                console.error(\"Error communicating with WhatsApp worker:\", err);\r\n            }\r\n        }\r\n\r\n        return NextResponse.json({ message: \"Messages queued successfully\", sentCount }, { status: 200 })\r\n    } catch (error) {\r\n        console.error(error);\r\n        return NextResponse.json(\r\n            { error: \"Internal server error\" },\r\n            { status: 500 }\r\n        )\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAoB;IAC3C,MAAM,OAAO,MAAM,IAAA,qIAAoB;IACvC,IAAI,CAAC,MAAM;QACP,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACtE;IAEA,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,cAAc,EAAE,GAAG;QAE3B,IAAI,CAAC,kBAAkB,OAAO,mBAAmB,YAAY,CAAC,eAAe,IAAI,IAAI;YACjF,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,OAAO;YAA8B,GACvC;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,QAAQ,MAAM,IAAA,4HAAW,EAAC,KAAK,IAAI,CAAC,EAAE;QAC5C,IAAI,CAAC,SAAS,MAAM,MAAM,KAAK,GAAG;YAC9B,OAAO,gJAAY,CAAC,IAAI,CACpB;gBAAE,OAAO;YAAyB,GAClC;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,uBAAuB,QAAQ,GAAG,CAAC,mBAAmB,IAAI;QAEhE,IAAI,YAAY;QAChB,KAAK,MAAM,QAAQ,MAAO;YACtB,MAAM,cAAc,CAAC,CAAC,EAAE,KAAK,IAAI,CAAC,GAAG,EAAE,KAAK,WAAW,CAAC,EAAE,EAAE,KAAK,GAAG,EAAE;YAEtE,IAAI;gBACA,MAAM,MAAM,MAAM,MAAM,sBAAsB;oBAC1C,QAAQ;oBACR,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9C,MAAM,KAAK,SAAS,CAAC;wBACjB,gBAAgB,eAAe,IAAI;wBACnC;oBACJ;gBACJ;gBAEA,IAAI,IAAI,EAAE,EAAE;oBACR;gBACJ,OAAO;oBACH,QAAQ,KAAK,CAAC,gCAAgC,KAAK,IAAI;gBAC3D;YACJ,EAAE,OAAO,KAAK;gBACV,QAAQ,KAAK,CAAC,6CAA6C;YAC/D;QACJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAgC;QAAU,GAAG;YAAE,QAAQ;QAAI;IACnG,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC;QACd,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}